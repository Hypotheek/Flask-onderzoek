<!doctype html>
<title>Register - Flaskr</title>
<link rel="stylesheet" href="style.css">
<script src="layout.js"></script>

<section class="content">
  <header>
    <h1>Register</h1>
  </header>

  <form id="registerForm">
    <label for="username">Username</label>
    <input name="username" id="username" required>
    <label for="password">Password</label>
    <input type="password" name="password" id="password" required>
    <input type="submit" value="Register">
  </form>
</section>

<script>
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = {
            username: document.getElementById('username').value,
            password: document.getElementById('password').value
        };

        const res = await fetch('/auth/register', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(formData)
        });

        const data = await res.json();
        if (res.ok) {
            window.location.href = '/login';
        } else {
            window.flash(data.error);
        }
    });
</script>